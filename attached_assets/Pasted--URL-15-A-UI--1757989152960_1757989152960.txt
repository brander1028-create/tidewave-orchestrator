주요 변경: ① URL 입력란 → “바로가기” 버튼 + 유지기간(연속 노출 일수) 표시 ② 블로그 랭크 파싱을 “서치피드 위 영역만”으로 제한(없으면 15위까지만).

A) UI/폼/테이블 변경

수동 블로그 입력 모달

“순위(선택)” 삭제(자동 수집).

블로그 URL 입력은 유지하되, 리스트/테이블에서는 텍스트 필드 대신 “바로가기” 버튼만 노출.

닉네임 자동 추출(편집 가능) 유지.

순위 테이블 컬럼 재구성

키워드 → 키워드 [조회량] [점수] 배지 같이 표기(키워드 DB 프록시 재사용).

순위 옆에 유지기간(연속 노출 일수) 뱃지: 예) 12위 | 유지 4일.

페이지 컬럼 제거 → “바로가기” 버튼(외부 링크 아이콘).

필터: 노출만 / 미노출만 토글 유지.

트렌드: 7일 스파크라인 + Δ7d(설정에서 7/10/14일 선택).

버튼 고장 수정

“전체 체크 시작” 버튼 disabled 조건을 단순화하고 onClick에 runAllChecks() 연결(블로그→쇼핑 순으로 호출, 폴링 3–5회).

B) 키워드 조회량/점수 연동 (이미 있는 DB 사용)

서버 프록시(있다면 그대로 사용):
GET /api/keywords/lookup?texts=키1,키2 → [ {text, volume, score} ]

프론트:

키워드 칩 우측에 [조회량] [점수] 배지 렌더.

정렬 드롭다운: 조회량순 / 점수순 / 가나다순.

C) 블로그 랭크 파싱 “서치피드 위” 제한

새 설정(ENV 또는 상수):

BLOG_BOUNDARY_MODE=above_searchfeed   # 기본값
BLOG_FALLBACK_MAX_RANK=15             # 서치피드 모듈이 없을 때 최대 탐색 순위


동작 규칙

모바일 네이버 SERP 1페이지를 파싱하면서 “서치피드에서 더 다양한 콘텐츠…”(텍스트 센티넬) 또는 해당 모듈 컨테이너를 만나는 순간 STOP. 그 위에 있는 결과만 후보로 인정.

페이지에 그 모듈이 없으면 결과 최대 15위까지만 스캔.

타겟 매칭은 정확 URL 우선, 실패 시 닉네임 일치로 보조.

찾으면 rank/page/pos 기록, 못 찾으면 exposed=false로 미노출 처리.

구현 힌트(의사코드) — serpScraper.checkKeywordRankingInMobileNaver():

const results = [];
for (const block of blogResultBlocks) {
  if (containsSearchFeedBoundary(block)) break;   // "서치피드..." 문구/모듈 감지
  results.push(block);
  if (!hasBoundary && results.length >= BLOG_FALLBACK_MAX_RANK) break;
}
// 이후 URL 또는 닉네임으로 타겟 매칭


containsSearchFeedBoundary: 텍스트 포함(“서치피드에서 더 다양한 콘텐츠”), 또는 서치피드 섹션 selector(여러 후보)를 OR 매칭.

D) “유지기간(연속 노출 일수)” 계산

정의: 해당 키워드×타겟이 1페이지에 노출(exposed=true)된 상태가 끊기지 않고 지속된 일수.
노출이 하루라도 끊기면 1일로 리셋.

스키마 추가

rank_snapshots에 exposed boolean(rank!=null && page==1 && boundary조건 충족).

선택: 가속화를 원하면 exposure_runs 테이블 추가
exposure_runs(id, target_id, query, started_on, last_seen_on, days)
스냅샷 insert 시 업데이트(오늘 노출이면 days+1 또는 새 run 생성).

API 응답 확장

GET /api/rank/history와 리스트 API에 exposed와 streak_days 포함:

{ ts, rank, exposed: true, streak_days: 4, ... }


UI

순위 오른쪽에 유지 n일 뱃지(녹색/회색).

E) API 요약(이번 델타로 바뀌는 부분만)

POST /api/rank/blog/check : 내부 파서가 서치피드 경계 적용 & exposed 설정.

GET /api/rank/history?kind=blog&target_id=... : {rank, exposed, streak_days} 반환 필드 포함.

키워드 프록시: GET /api/keywords/lookup?texts=... (캐시 1h).

F) 수락 기준(DoD)

리스트에서 URL 텍스트가 사라지고 “바로가기” 버튼으로 열림.

**키워드 [조회량] [점수]**가 칩에 표시되고 조회량순/점수순 정렬이 동작.

순위 오른쪽에 유지기간 뱃지가 보이며, 하루 노출이 끊기면 다음 날 1일로 리셋.

랭크 파서는 서치피드 문구 위 결과만 반영되고, 문구가 없을 때는 15위까지만 탐색.

“전체 체크 시작” 버튼이 활성화·동작하고, 동일 키워드라도 여러 블로그 타겟을 각각 체크(행 분리).

노출만 / 미노출만 필터가 정상 동작.

왜 이 구성이 좋은가

랭크 품질: 모바일 1페이지 중에서도 **실제 상단 노출 영역(서치피드 위)**만 반영 → 체감과 일치.

속도/비용: 서치피드 센티넬로 조기 중단, 불필요한 하단 파싱 제거.

운영: 유지기간으로 “이번 글이 며칠째 노출 유지 중인지” 바로 파악.

원하면 버튼/배지 라벨(예: “유지 4일”, “미노출”) 문구·색상 가이드까지 바로 내려줄게.