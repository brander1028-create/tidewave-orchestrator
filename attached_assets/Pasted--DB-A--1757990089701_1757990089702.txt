내 자산 전용 + 블로그 대시보드/그룹/DB 페이지 + 비용가드
A) 내비 구조 재정렬

좌측 메뉴를 분리:

대시보드(블로그) ← 신규

블로그 순위

쇼핑몰 순위

리뷰 랭킹

인사이트(공통)

제출함

알림

데이터베이스 ← 신규

설정

기존 “순위 체크” 한 페이지에 몰던 걸 분리. “대시보드(블로그)” 안에 블로그 순위 요약 + 인사이트를 함께 보여줌.

B) 대시보드(블로그) 페이지 구성

Top Ticker(얇은 롤링 바)

내용: “순위 변동 알림” 중 조회량 상위 키워드 TOP10만 좌→우 자동 롤링

포맷: 키워드 [조회량] 12→5위(▲7) · 미노출→9위(▲) 등

데이터 소스: /api/alerts?type=rank_change&since=24h + /api/keywords/lookup(volume)

대시보드 카드(사용자 편집 가능)

Grid 편집(드래그/리사이즈) + 저장(사용자별)

제공 위젯:

“나의 키워드 그룹” 요약(아래 C항의 그룹)

Top movers(상승/하락 5개)

노출 유지 TOP(유지기간 상위 5개)

최근 미노출 전환

키워드 분포(Top10/미노출 비율 도넛)

7일 스파크라인 보드

편집 진입: “대시보드 편집” 토글

블로그 인사이트(요약 섹션)

KPI: 평균순위, Top10 커버리지(%), 7일 변동성(vol7), WoW, MoM

차트: ① 멀티라인(rank_score=101-rank) ② Δ바(일일) ③ 캘린더 히트맵(월간)

C) 키워드 그룹 기능 (새로)

개념: 추적 키워드를 담당자 임의로 묶는 그룹(예: “홍삼_브랜딩”, “프로모션A”)

스키마:

groups(id, name, owner, created_at, active)

group_keywords(group_id, keyword_text) // 단순 many-to-many

group_index_daily(group_id, date, rank_score_avg, top10_coverage, dd, wow, mom)

API:

POST/GET/PATCH/DELETE /api/groups

POST/DELETE /api/groups/:id/keywords (배치 추가/삭제)

GET /api/groups/:id/index?range=30d

지표 정의:

rank_score_avg: 그룹 포함 키워드들의 해당일 평균(101-rank) (미노출은 0점 처리)

top10_coverage: 그룹 키워드 중 Top10 비율

대시보드 카드:

그룹 KPI 타일(색상 배지: 개선/악화), 클릭 시 그룹 자세히(스파크라인+표)

D) 블로그 순위 페이지 UX 정돈

키워드 관리 패널: 기본 접힘 상태, [펼치기] 클릭 시 슬라이드다운

검색/필터/정렬 전면 적용

검색: 키워드·닉네임·URL 부분검색

필터: 노출만 / 미노출만 / 유지 n일 이상 / Δ≥N

정렬: 최근 업데이트 / Δ / 현재순위 / 조회량 / 점수

URL 칼럼 → “바로가기” 아이콘 버튼(새 창)

순위 옆 “유지 n일” 배지 표기 (v6.2 규칙 유지)

페이지 범위 입력 UI 제거(우리는 서치피드 경계 위 + 없으면 15위 규칙 고정)

E) 데이터베이스 페이지(신규)

목적: API 호출 줄이고, 장기 비교 가능하도록 보관/관리

탭 구성:

키워드 보관소

컬럼: 키워드, [조회량], [점수], 최초수집, 최근수집, 누적스냅샷, 상태(수집중/중지)

액션: 수집 중지/재개(토글), “그룹에 추가”

타겟(블로그/상품)

컬럼: 닉네임/상품, 쿼리수, 스케줄, 최근성공/실패, 유지기간, 상태

액션: 중지/재개, 즉시 체크

스냅샷 요약

일 집계: rank_agg_day(평균/최저/최고/노출수/미노출수)

보관 정책: 최근 180일 유지(설정에서 변경 가능)

수집 규칙/러너

현재 스케줄, 토큰 사용 추정, 캐시 히트율, 429 비율

자동 중지 규칙(비용 가드):

“해당 키워드×타겟이 최근 30일 Top 페이지 미진입 시 자동 수집 중지”

중지 시 알림 1회 발송, DB 페이지에서 재개 가능

F) DB/집계 스키마(추가)

rank_agg_day(target_id, query, date, rank_avg, rank_min, rank_max, exposed_count, not_exposed_count, dd, wow, mom, vol7)

collection_rules(target_id, rule jsonb) // 예: {autoSuspendIfNoTop:true, days:30}

collection_state(target_id, enabled, last_run_ts, last_status, tokens_used_7d)

(기존) exposure_runs 또는 streak_days 계산 로직 유지

G) API(추가/변경)

그룹

POST/GET/PATCH/DELETE /api/groups

POST/DELETE /api/groups/:id/keywords

GET /api/groups/:id/index?range=30d

DB 페이지용

GET /api/db/keywords?query=&state=&sort=volume|score|updated_at

POST /api/db/keywords/:text/toggle // 수집 중지/재개

GET /api/db/targets?type=blog|product&state=&sort=...

POST /api/db/targets/:id/toggle

GET /api/db/snapshots/agg?range=180d

GET/POST /api/db/collection-rules // 자동 중지 규칙 CRUD

대시보드용

GET /api/alerts/rolling?limit=10&since=24h // Ticker 데이터

순위 페이지 공통

모든 목록 응답에 exposed·streak_days 포함(이미 v6.2 반영)

H) 스케줄러/집계 작업

매 시각: 랭크 체크(타겟별 cron), 리뷰 체크

일 자정(로컬): rank_agg_day / group_index_daily 리빌드

매 1시간: 자동 중지 규칙 평가(30일 미진입 → suspend)

I) 수락 기준(DoD)

좌측 메뉴가 대시보드(블로그) / 블로그 순위 / 쇼핑몰 순위 / 리뷰 랭킹으로 분리됨.

대시보드 상단에 롤링 Ticker가 보이고, 카드들을 사용자별 편집/저장 가능.

그룹 생성/편집 후, 그룹 KPI와 그룹 지수 차트가 표시됨.

블로그 순위 페이지의 키워드 관리 패널이 접힘 기본이며, 검색/필터/정렬이 동작.

리스트에서 URL 대신 “바로가기” 버튼, 순위 옆 유지 n일 배지 표기.

데이터베이스 페이지에서 키워드/타겟/스냅샷/규칙을 조회·중지/재개할 수 있고, 30일 미진입 자동 중지가 동작.

인사이트에서 YoY/MoM/WoW 비교가 보이며(집계 스키마 기반), API 호출을 최소화(캐시/집계·보관 정책 적용).

J) 구현 메모(간단)

페이지 범위 UI 제거(경계 모드 고정).

키워드 배지: [조회량] [점수](lookup 캐시 1h).

롤링 Ticker는 4~6초 간격 오토슬라이드(모바일 폭에서는 좌우 스크롤).

그룹 지수 계산에서 미노출은 score=0 처리(체감과 일치).

집계 스키마로 그래프는 DB값 바로 사용 → API 호출/클라 연산 최소화.